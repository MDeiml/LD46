<!DOCTYPE html>
<html>
    <head>
        <title>LD46 - Warmup</title>
        <script type="module" src="main.js"></script>
        <script id="shader-vs" type="x-shader/x-vertex">
            attribute vec3 position;
            attribute vec2 texCoord;

            varying mediump vec2 vTexCoord;
            varying mediump vec2 worldPos;

            uniform mat4 M;
            uniform mat4 MVP;

            void main(void) {
                vTexCoord = texCoord;
                worldPos = (M * vec4(position, 1.0)).xy;
                gl_Position = MVP * vec4(position, 1.0);
            }
        </script>
        <script id="shader-fs" type="x-shader/x-fragment">
            precision mediump float;

            varying mediump vec2 vTexCoord;
            varying mediump vec2 worldPos;

            uniform sampler2D texture;

            void main(void) {
                vec4 color = texture2D(texture, vTexCoord);
                float t = clamp(1.0/dot(worldPos, worldPos), 0.0, 1.0);
                float gray = color.r * 0.3 + color.g * 0.59 + color.b * 0.11;
                vec3 grayColor = gray * vec3(79.0/255.0, 79.0/255.0, 128.0/255.0);
                color.rgb = (1.0 - t) * grayColor + t * color.rgb;
                gl_FragColor = color;
            }
        </script>
    </head>
    <body>
        <canvas id="glCanvas" width="800" height="600">
    </body>
</html>
